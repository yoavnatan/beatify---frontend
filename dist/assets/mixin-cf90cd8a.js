var qt=Object.defineProperty;var Ot=(i,e,t)=>e in i?qt(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var u=(i,e,t)=>(Ot(i,typeof e!="symbol"?e+"":e,t),t),ot=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)};var o=(i,e,t)=>(ot(i,e,"read from private field"),t?t.call(i):e.get(i)),c=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},a=(i,e,t,n)=>(ot(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t);var b=(i,e,t)=>(ot(i,e,"access private method"),t);const jt=["abort","canplay","canplaythrough","durationchange","emptied","encrypted","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting","waitingforkey","resize","enterpictureinpicture","leavepictureinpicture","webkitbeginfullscreen","webkitendfullscreen","webkitpresentationmodechanged"],bt=["autopictureinpicture","disablepictureinpicture","disableremoteplayback","autoplay","controls","controlslist","crossorigin","loop","muted","playsinline","poster","preload","src"];function Pt(i){return`
    <style>
      :host {
        display: inline-flex;
        line-height: 0;
        flex-direction: column;
        justify-content: end;
      }

      audio {
        width: 100%;
      }
    </style>
    <slot name="media">
      <audio${St(i)}></audio>
    </slot>
    <slot></slot>
  `}function $t(i){return`
    <style>
      :host {
        display: inline-block;
        line-height: 0;
      }

      video {
        max-width: 100%;
        max-height: 100%;
        min-width: 100%;
        min-height: 100%;
        object-fit: var(--media-object-fit, contain);
        object-position: var(--media-object-position, 50% 50%);
      }

      video::-webkit-media-text-track-container {
        transform: var(--media-webkit-text-track-transform);
        transition: var(--media-webkit-text-track-transition);
      }
    </style>
    <slot name="media">
      <video${St(i)}></video>
    </slot>
    <slot></slot>
  `}function wt(i,{tag:e,is:t}){var g,p,v,m,Y,Tt,W,G,E,J,T,V,K,st,Z,Et,Q,dt,_,Lt,tt,Rt;const n=(p=(g=globalThis.document)==null?void 0:g.createElement)==null?void 0:p.call(g,e,{is:t}),d=n?Mt(n):[];return v=class extends i{constructor(){super(...arguments);c(this,T);c(this,K);c(this,Z);c(this,Q);c(this,_);c(this,tt);c(this,W,!1);c(this,G,null);c(this,E,new Map);c(this,J,void 0);u(this,"get");u(this,"set");u(this,"call")}static get observedAttributes(){var h,k;return b(h=v,Y,Tt).call(h),[...((k=n==null?void 0:n.constructor)==null?void 0:k.observedAttributes)??[],...bt]}get nativeEl(){var s;return b(this,T,V).call(this),o(this,G)??this.querySelector(":scope > [slot=media]")??this.querySelector(e)??((s=this.shadowRoot)==null?void 0:s.querySelector(e))??null}set nativeEl(s){a(this,G,s)}get defaultMuted(){return this.hasAttribute("muted")}set defaultMuted(s){this.toggleAttribute("muted",s)}get src(){return this.getAttribute("src")}set src(s){this.setAttribute("src",`${s}`)}get preload(){var s;return this.getAttribute("preload")??((s=this.nativeEl)==null?void 0:s.preload)}set preload(s){this.setAttribute("preload",`${s}`)}init(){if(!this.shadowRoot){this.attachShadow({mode:"open"});const s=Vt(this.attributes);t&&(s.is=t),e&&(s.part=e),this.shadowRoot.innerHTML=this.constructor.getTemplateHTML(s)}this.nativeEl.muted=this.hasAttribute("muted");for(const s of d)b(this,_,Lt).call(this,s);a(this,J,new MutationObserver(b(this,Z,Et).bind(this))),this.shadowRoot.addEventListener("slotchange",()=>b(this,K,st).call(this)),b(this,K,st).call(this);for(const s of this.constructor.Events)this.shadowRoot.addEventListener(s,this,!0)}handleEvent(s){s.target===this.nativeEl&&this.dispatchEvent(new CustomEvent(s.type,{detail:s.detail}))}attributeChangedCallback(s,h,k){b(this,T,V).call(this),b(this,tt,Rt).call(this,s,h,k)}connectedCallback(){b(this,T,V).call(this)}},m=new WeakMap,Y=new WeakSet,Tt=function(){if(o(this,m))return;a(this,m,!0);const s=new Set(this.observedAttributes);s.delete("muted");for(const h of d)if(!(h in this.prototype))if(typeof n[h]=="function")this.prototype[h]=function(...k){return b(this,T,V).call(this),(()=>{var y;if(this.call)return this.call(h,...k);const f=(y=this.nativeEl)==null?void 0:y[h];return f==null?void 0:f.apply(this.nativeEl,k)})()};else{const k={get(){var f,y;b(this,T,V).call(this);const l=h.toLowerCase();if(s.has(l)){const H=this.getAttribute(l);return H===null?!1:H===""?!0:H}return((f=this.get)==null?void 0:f.call(this,h))??((y=this.nativeEl)==null?void 0:y[h])}};h!==h.toUpperCase()&&(k.set=function(l){b(this,T,V).call(this);const f=h.toLowerCase();if(s.has(f)){l===!0||l===!1||l==null?this.toggleAttribute(f,!!l):this.setAttribute(f,l);return}if(this.set){this.set(h,l);return}this.nativeEl&&(this.nativeEl[h]=l)}),Object.defineProperty(this.prototype,h,k)}},W=new WeakMap,G=new WeakMap,E=new WeakMap,J=new WeakMap,T=new WeakSet,V=function(){o(this,W)||(a(this,W,!0),this.init())},K=new WeakSet,st=function(){var l;const s=new Map(o(this,E)),h=(l=this.shadowRoot)==null?void 0:l.querySelector("slot:not([name])");(h==null?void 0:h.assignedElements({flatten:!0}).filter(f=>["track","source"].includes(f.localName))).forEach(f=>{var H,kt;s.delete(f);let y=o(this,E).get(f);y||(y=f.cloneNode(),o(this,E).set(f,y),(H=o(this,J))==null||H.observe(f,{attributes:!0})),(kt=this.nativeEl)==null||kt.append(y),b(this,Q,dt).call(this,y)}),s.forEach((f,y)=>{f.remove(),o(this,E).delete(y)})},Z=new WeakSet,Et=function(s){for(const h of s)if(h.type==="attributes"){const{target:k,attributeName:l}=h,f=o(this,E).get(k);f&&l&&(f.setAttribute(l,k.getAttribute(l)??""),b(this,Q,dt).call(this,f))}},Q=new WeakSet,dt=function(s){s&&s.localName==="track"&&s.default&&(s.kind==="chapters"||s.kind==="metadata")&&s.track.mode==="disabled"&&(s.track.mode="hidden")},_=new WeakSet,Lt=function(s){if(Object.prototype.hasOwnProperty.call(this,s)){const h=this[s];delete this[s],this[s]=h}},tt=new WeakSet,Rt=function(s,h,k){var l,f,y;["id","class"].includes(s)||!v.observedAttributes.includes(s)&&this.constructor.observedAttributes.includes(s)||(k===null?(l=this.nativeEl)==null||l.removeAttribute(s):((f=this.nativeEl)==null?void 0:f.getAttribute(s))!==k&&((y=this.nativeEl)==null||y.setAttribute(s,k)))},c(v,Y),u(v,"getTemplateHTML",e.endsWith("audio")?Pt:$t),u(v,"shadowRootOptions",{mode:"open"}),u(v,"Events",jt),c(v,m,!1),v}function Mt(i){const e=[];for(let t=Object.getPrototypeOf(i);t&&t!==HTMLElement.prototype;t=Object.getPrototypeOf(t)){const n=Object.getOwnPropertyNames(t);e.push(...n)}return e}function St(i){let e="";for(const t in i){if(!bt.includes(t))continue;const n=i[t];n===""?e+=` ${t}`:e+=` ${t}="${n}"`}return e}function Vt(i){const e={};for(const t of i)e[t.name]=t.value;return e}const Yt=wt(globalThis.HTMLElement??class{},{tag:"video"});wt(globalThis.HTMLElement??class{},{tag:"audio"});class nt extends Event{constructor(t,n){super(t);u(this,"track");this.track=n.track}}const at=new WeakMap;function r(i){return at.get(i)??It(i,{})}function It(i,e){let t=at.get(i);return t||at.set(i,t={}),Object.assign(t,e)}function ct(i,e){const t=i.videoTracks;r(e).media=i,r(e).renditionSet||(r(e).renditionSet=new Set);const n=r(t).trackSet;n.add(e);const d=n.size-1;d in ht.prototype||Object.defineProperty(ht.prototype,d,{get(){return[...r(this).trackSet][d]}}),queueMicrotask(()=>{t.dispatchEvent(new nt("addtrack",{track:e}))})}function ut(i){var n;const e=(n=r(i).media)==null?void 0:n.videoTracks;if(!e)return;r(e).trackSet.delete(i),queueMicrotask(()=>{e.dispatchEvent(new nt("removetrack",{track:i}))})}function Ht(i){const e=r(i).media.videoTracks??[];let t=!1;for(const n of e)n!==i&&(n.selected=!1,t=!0);if(t){if(r(e).changeRequested)return;r(e).changeRequested=!0,queueMicrotask(()=>{delete r(e).changeRequested,e.dispatchEvent(new Event("change"))})}}var L,R,w,I,X;class ht extends EventTarget{constructor(){super();c(this,I);c(this,L,void 0);c(this,R,void 0);c(this,w,void 0);r(this).trackSet=new Set}[Symbol.iterator](){return o(this,I,X).values()}get length(){return o(this,I,X).size}getTrackById(t){return[...o(this,I,X)].find(n=>n.id===t)??null}get selectedIndex(){return[...o(this,I,X)].findIndex(t=>t.selected)}get onaddtrack(){return o(this,L)}set onaddtrack(t){o(this,L)&&(this.removeEventListener("addtrack",o(this,L)),a(this,L,void 0)),typeof t=="function"&&(a(this,L,t),this.addEventListener("addtrack",t))}get onremovetrack(){return o(this,R)}set onremovetrack(t){o(this,R)&&(this.removeEventListener("removetrack",o(this,R)),a(this,R,void 0)),typeof t=="function"&&(a(this,R,t),this.addEventListener("removetrack",t))}get onchange(){return o(this,w)}set onchange(t){o(this,w)&&(this.removeEventListener("change",o(this,w)),a(this,w,void 0)),typeof t=="function"&&(a(this,w,t),this.addEventListener("change",t))}}L=new WeakMap,R=new WeakMap,w=new WeakMap,I=new WeakSet,X=function(){return r(this).trackSet};class rt extends Event{constructor(t,n){super(t);u(this,"rendition");this.rendition=n.rendition}}function zt(i,e){const t=r(i).media.videoRenditions;r(e).media=r(i).media,r(e).track=i;const n=r(i).renditionSet;n.add(e);const d=n.size-1;d in ft.prototype||Object.defineProperty(ft.prototype,d,{get(){return z(this)[d]}}),queueMicrotask(()=>{i.selected&&t.dispatchEvent(new rt("addrendition",{rendition:e}))})}function Bt(i){const e=r(i).media.videoRenditions,t=r(i).track;r(t).renditionSet.delete(i),queueMicrotask(()=>{r(i).track.selected&&e.dispatchEvent(new rt("removerendition",{rendition:i}))})}function Ct(i){const e=r(i).media.videoRenditions;!e||r(e).changeRequested||(r(e).changeRequested=!0,queueMicrotask(()=>{delete r(e).changeRequested,r(i).track.selected&&e.dispatchEvent(new Event("change"))}))}function z(i){return[...r(i).media.videoTracks].filter(t=>t.selected).flatMap(t=>[...r(t).renditionSet])}var S,A,x;class ft extends EventTarget{constructor(){super(...arguments);c(this,S,void 0);c(this,A,void 0);c(this,x,void 0)}[Symbol.iterator](){return z(this).values()}get length(){return z(this).length}getRenditionById(t){return z(this).find(n=>`${n.id}`==`${t}`)??null}get selectedIndex(){return z(this).findIndex(t=>t.selected)}set selectedIndex(t){for(const[n,d]of z(this).entries())d.selected=n===t}get onaddrendition(){return o(this,S)}set onaddrendition(t){o(this,S)&&(this.removeEventListener("addrendition",o(this,S)),a(this,S,void 0)),typeof t=="function"&&(a(this,S,t),this.addEventListener("addrendition",t))}get onremoverendition(){return o(this,A)}set onremoverendition(t){o(this,A)&&(this.removeEventListener("removerendition",o(this,A)),a(this,A,void 0)),typeof t=="function"&&(a(this,A,t),this.addEventListener("removerendition",t))}get onchange(){return o(this,x)}set onchange(t){o(this,x)&&(this.removeEventListener("change",o(this,x)),a(this,x,void 0)),typeof t=="function"&&(a(this,x,t),this.addEventListener("change",t))}}S=new WeakMap,A=new WeakMap,x=new WeakMap;var C;class Ft{constructor(){u(this,"src");u(this,"id");u(this,"width");u(this,"height");u(this,"bitrate");u(this,"frameRate");u(this,"codec");c(this,C,!1)}get selected(){return o(this,C)}set selected(e){o(this,C)!==e&&(a(this,C,e),Ct(this))}}C=new WeakMap;var F;class At{constructor(){u(this,"id");u(this,"kind");u(this,"label","");u(this,"language","");u(this,"sourceBuffer");c(this,F,!1)}addRendition(e,t,n,d,g,p){const v=new Ft;return v.src=e,v.width=t,v.height=n,v.frameRate=p,v.bitrate=g,v.codec=d,zt(this,v),v}removeRendition(e){Bt(e)}get selected(){return o(this,F)}set selected(e){o(this,F)!==e&&(a(this,F,e),e===!0&&Ht(this))}}F=new WeakMap;function Dt(i,e){const t=r(i).media.audioRenditions;r(e).media=r(i).media,r(e).track=i;const n=r(i).renditionSet;n.add(e);const d=n.size-1;d in vt.prototype||Object.defineProperty(vt.prototype,d,{get(){return B(this)[d]}}),queueMicrotask(()=>{i.enabled&&t.dispatchEvent(new rt("addrendition",{rendition:e}))})}function Nt(i){const e=r(i).media.audioRenditions,t=r(i).track;r(t).renditionSet.delete(i),queueMicrotask(()=>{r(i).track.enabled&&e.dispatchEvent(new rt("removerendition",{rendition:i}))})}function Ut(i){const e=r(i).media.audioRenditions;!e||r(e).changeRequested||(r(e).changeRequested=!0,queueMicrotask(()=>{delete r(e).changeRequested,r(i).track.enabled&&e.dispatchEvent(new Event("change"))}))}function B(i){return[...r(i).media.audioTracks].filter(t=>t.enabled).flatMap(t=>[...r(t).renditionSet])}var q,O,j;class vt extends EventTarget{constructor(){super(...arguments);c(this,q,void 0);c(this,O,void 0);c(this,j,void 0)}[Symbol.iterator](){return B(this).values()}get length(){return B(this).length}getRenditionById(t){return B(this).find(n=>`${n.id}`==`${t}`)??null}get selectedIndex(){return B(this).findIndex(t=>t.selected)}set selectedIndex(t){for(const[n,d]of B(this).entries())d.selected=n===t}get onaddrendition(){return o(this,q)}set onaddrendition(t){o(this,q)&&(this.removeEventListener("addrendition",o(this,q)),a(this,q,void 0)),typeof t=="function"&&(a(this,q,t),this.addEventListener("addrendition",t))}get onremoverendition(){return o(this,O)}set onremoverendition(t){o(this,O)&&(this.removeEventListener("removerendition",o(this,O)),a(this,O,void 0)),typeof t=="function"&&(a(this,O,t),this.addEventListener("removerendition",t))}get onchange(){return o(this,j)}set onchange(t){o(this,j)&&(this.removeEventListener("change",o(this,j)),a(this,j,void 0)),typeof t=="function"&&(a(this,j,t),this.addEventListener("change",t))}}q=new WeakMap,O=new WeakMap,j=new WeakMap;var D;class Wt{constructor(){u(this,"src");u(this,"id");u(this,"bitrate");u(this,"codec");c(this,D,!1)}get selected(){return o(this,D)}set selected(e){o(this,D)!==e&&(a(this,D,e),Ut(this))}}D=new WeakMap;function lt(i,e){const t=i.audioTracks;r(e).media=i,r(e).renditionSet||(r(e).renditionSet=new Set);const n=r(t).trackSet;n.add(e);const d=n.size-1;d in gt.prototype||Object.defineProperty(gt.prototype,d,{get(){return[...r(this).trackSet][d]}}),queueMicrotask(()=>{t.dispatchEvent(new nt("addtrack",{track:e}))})}function pt(i){var n;const e=(n=r(i).media)==null?void 0:n.audioTracks;if(!e)return;r(e).trackSet.delete(i),queueMicrotask(()=>{e.dispatchEvent(new nt("removetrack",{track:i}))})}function Gt(i){const e=r(i).media.audioTracks;!e||r(e).changeRequested||(r(e).changeRequested=!0,queueMicrotask(()=>{delete r(e).changeRequested,e.dispatchEvent(new Event("change"))}))}var P,$,M,N,et;class gt extends EventTarget{constructor(){super();c(this,N);c(this,P,void 0);c(this,$,void 0);c(this,M,void 0);r(this).trackSet=new Set}[Symbol.iterator](){return o(this,N,et).values()}get length(){return o(this,N,et).size}getTrackById(t){return[...o(this,N,et)].find(n=>n.id===t)??null}get onaddtrack(){return o(this,P)}set onaddtrack(t){o(this,P)&&(this.removeEventListener("addtrack",o(this,P)),a(this,P,void 0)),typeof t=="function"&&(a(this,P,t),this.addEventListener("addtrack",t))}get onremovetrack(){return o(this,$)}set onremovetrack(t){o(this,$)&&(this.removeEventListener("removetrack",o(this,$)),a(this,$,void 0)),typeof t=="function"&&(a(this,$,t),this.addEventListener("removetrack",t))}get onchange(){return o(this,M)}set onchange(t){o(this,M)&&(this.removeEventListener("change",o(this,M)),a(this,M,void 0)),typeof t=="function"&&(a(this,M,t),this.addEventListener("change",t))}}P=new WeakMap,$=new WeakMap,M=new WeakMap,N=new WeakSet,et=function(){return r(this).trackSet};var U;class xt{constructor(){u(this,"id");u(this,"kind");u(this,"label","");u(this,"language","");u(this,"sourceBuffer");c(this,U,!1)}addRendition(e,t,n){const d=new Wt;return d.src=e,d.codec=t,d.bitrate=n,Dt(this,d),d}removeRendition(e){Nt(e)}get enabled(){return o(this,U)}set enabled(e){o(this,U)!==e&&(a(this,U,e),Gt(this))}}U=new WeakMap;const mt=it(globalThis.HTMLMediaElement,"video"),yt=it(globalThis.HTMLMediaElement,"audio");function Zt(i){if(!(i!=null&&i.prototype))return i;const e=it(i,"video");(!e||`${e}`.includes("[native code]"))&&Object.defineProperty(i.prototype,"videoTracks",{get(){return Jt(this)}});const t=it(i,"audio");(!t||`${t}`.includes("[native code]"))&&Object.defineProperty(i.prototype,"audioTracks",{get(){return Kt(this)}}),"addVideoTrack"in i.prototype||(i.prototype.addVideoTrack=function(g,p="",v=""){const m=new At;return m.kind=g,m.label=p,m.language=v,ct(this,m),m}),"removeVideoTrack"in i.prototype||(i.prototype.removeVideoTrack=ut),"addAudioTrack"in i.prototype||(i.prototype.addAudioTrack=function(g,p="",v=""){const m=new xt;return m.kind=g,m.label=p,m.language=v,lt(this,m),m}),"removeAudioTrack"in i.prototype||(i.prototype.removeAudioTrack=pt),"videoRenditions"in i.prototype||Object.defineProperty(i.prototype,"videoRenditions",{get(){return n(this)}});const n=g=>{let p=r(g).videoRenditions;return p||(p=new ft,r(p).media=g,r(g).videoRenditions=p),p};"audioRenditions"in i.prototype||Object.defineProperty(i.prototype,"audioRenditions",{get(){return d(this)}});const d=g=>{let p=r(g).audioRenditions;return p||(p=new vt,r(p).media=g,r(g).audioRenditions=p),p};return i}function it(i,e){var t;if(i!=null&&i.prototype)return(t=Object.getOwnPropertyDescriptor(i.prototype,`${e}Tracks`))==null?void 0:t.get}function Jt(i){let e=r(i).videoTracks;if(!e&&(e=new ht,r(i).videoTracks=e,mt)){const t=mt.call(i.nativeEl??i);for(const n of t)ct(i,n);t.addEventListener("change",()=>{e.dispatchEvent(new Event("change"))}),t.addEventListener("addtrack",n=>{if([...e].some(d=>d instanceof At)){for(const d of t)ut(d);return}ct(i,n.track)}),t.addEventListener("removetrack",n=>{ut(n.track)})}return e}function Kt(i){let e=r(i).audioTracks;if(!e&&(e=new gt,r(i).audioTracks=e,yt)){const t=yt.call(i.nativeEl??i);for(const n of t)lt(i,n);t.addEventListener("change",()=>{e.dispatchEvent(new Event("change"))}),t.addEventListener("addtrack",n=>{if([...e].some(d=>d instanceof xt)){for(const d of t)pt(d);return}lt(i,n.track)}),t.addEventListener("removetrack",n=>{pt(n.track)})}return e}export{Yt as C,Zt as M};
